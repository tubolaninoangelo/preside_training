!function(a){var b=a("[name=access_restriction]");if(b.length){var c,d=a("#fieldset-rules");c=function(){switch(b.val()){case"partial":case"full":d.show();break;default:d.hide()}},a("form").on("change","[name=access_restriction]",c),c()}}(presideJQuery),function(a){var b=function(b){return a.inArray(b.nodeName,["A","INPUT","BUTTON","TEXTAREA","SELECT"])>=0||a(b).parents("a:first,input:first,button:first,textarea:first,select:first").length};a("body").on("click",".page-type-picker .page-type",function(c){if(!b(c.target)){var d=a(this).find("a:first");d.length&&(c.preventDefault(),d.get(0).click())}})}(presideJQuery),function(a){a.fn.treeTable=function(){var b,c,d,e,f,g,h='<tr class="depth-{{depth}} ajax-loading" data-parent="{{parent}}" data-depth="{{depth}}"><td colspan="5"><i class="fa fa-fw fa-refresh fa-spin"></i> '+i18n.translateResource("cms:sitetree.ajax.loading.message")+"</td></tr>",i='<tr class="depth-{{depth}} ajax-loading-error" data-parent="{{parent}}" data-depth="{{depth}}"><td colspan="5"><i class="fa fa-fw fa-exclamation-circle"></i> '+i18n.translateResource("cms:sitetree.ajax.loading.error.message")+"</td></tr>",j=cfrequest.selectedNode||"";return b=function(c){g(c).show().each(function(){var c=a(this);g(c).length&&c.data("open")&&b(c)}),c.data("childrenLoaded")||c.data("childrenLoading")||f(c)},f=function(c){c.data("childrenLoading",!0);var d,e,f,k=g(c),l=a(Mustache.render(h,{depth:parseInt(c.data("depth"))+1,parent:c.data("id")}));k.length?a(k.get(k.length-1)).after(l):c.after(l),c.data("children",calculateChildren(c)),d=function(a){l.before(a)},e=function(){var b=a(Mustache.render(i,{depth:parseInt(c.data("depth"))+1,parent:c.data("id")}));l.before(b)},f=function(){var d=calculateChildren(c);l.remove(),c.data("childrenLoaded",!0),c.data("childrenLoading",!1),c.data("children",d),d.attr("tabindex",c.attr("tabindex")),d.filter("[data-open-on-start]").each(function(){b(a(this))})},a.ajax(buildAjaxLink("sitetree.ajaxChildNodes",{parentId:c.data("id"),selected:j}),{method:"GET",cache:!1,success:d,error:e,complete:f})},calculateChildren=function(a){return a.closest("table").find("tr[data-parent='"+a.data("id")+"']")},c=function(b){var d=g(b);d.length&&d.hide().each(function(){var b=a(this);g(b).length&&c(b)})},d=function(a){var d=a.find(".tree-toggler"),e=a.data("open");d.toggleClass("fa-caret-right"),d.toggleClass("fa-caret-down"),e?c(a):b(a),a.data("open",!e)},e=function(b){return a.inArray(b.nodeName,["A","INPUT","BUTTON","TEXTAREA","SELECT"])>=0||a(b).parents("a:first,input:first,button:first,textarea:first,select:first").length||a(b).data("toggle")},g=function(a){return void 0===a.data("children")&&a.data("children",calculateChildren(a)),a.data("children")},this.each(function(){var b=a(this),c=b.find("tr.selected:first");if(b.on("click",".tree-toggler",function(b){b.preventDefault();var c=a(this),e=c.closest("tr");d(e)}),b.on("keydown","tbody > tr","left",function(b){b.stopPropagation();var c=a(this);c.data("open")&&d(c)}),b.on("keydown","tbody > tr","return",function(b){if(!e(b)){var c=a(this).find("a:first");c.length&&(b.stopPropagation(),b.preventDefault(),c.get(0).click())}}),b.on("keydown","tbody > tr","right",function(b){b.stopPropagation();var c=a(this);c.data("open")||d(c)}),b.sortable({items:"tbody > tr",handle:".sortable-handle"}),c.length){for(var f=b.find("tr[data-id='"+(c.data("parent")||"")+"']");f.length;)d(f),f=b.find("tr[data-id='"+(f.data("parent")||"")+"']");d(c),c.focus(),c.blur(function(){a(this).removeClass("selected")})}else d(b.find("tr[data-has-children='true']").first())})},a(".tree-table").treeTable()}(presideJQuery);
//# sourceMappingURL=_sitetree.min.map